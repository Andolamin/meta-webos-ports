From cf846aeb4ed7091b5cea67a3810f8614ff13d301 Mon Sep 17 00:00:00 2001
From: Martin Jansa <Martin.Jansa@gmail.com>
Date: Fri, 19 Dec 2014 19:31:06 +0100
Subject: [PATCH] replace cjson with json-c

Signed-off-by: Martin Jansa <Martin.Jansa@gmail.com>
---
 CMakeLists.txt                                     | 6 +++---
 Src/base/BootManager.cpp                           | 2 +-
 Src/base/EventReporter.cpp                         | 2 +-
 Src/base/application/ApplicationDescription.cpp    | 2 +-
 Src/base/application/ApplicationInstaller.cpp      | 6 +++---
 Src/base/application/ApplicationInstaller.h        | 4 ++--
 Src/base/application/ApplicationManager.cpp        | 2 +-
 Src/base/application/ApplicationManagerService.cpp | 4 ++--
 Src/base/application/ApplicationStatus.cpp         | 2 +-
 Src/base/application/CmdResourceHandlers.cpp       | 4 ++--
 Src/base/application/LaunchPoint.cpp               | 2 +-
 Src/base/application/MimeSystem.cpp                | 4 ++--
 Src/base/application/PackageDescription.h          | 2 +-
 Src/base/application/ServiceDescription.cpp        | 2 +-
 Src/remote/WebAppMgrProxy.cpp                      | 2 +-
 15 files changed, 23 insertions(+), 23 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 6c4584e..afbf402 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -44,7 +44,7 @@ pkg_check_modules(LUNA_PREFS luna-prefs REQUIRED)
 pkg_check_modules(NYX nyx REQUIRED)
 pkg_check_modules(PBNJSON_CPP pbnjson_cpp REQUIRED)
 pkg_check_modules(PBNJSON_C pbnjson_c REQUIRED)
-pkg_check_modules(CJSON cjson REQUIRED)
+pkg_check_modules(JSON json-c REQUIRED)
 pkg_check_modules(SQLITE3 sqlite3 REQUIRED)
 pkg_check_modules(OPENSSL openssl REQUIRED)
 pkg_check_modules(SERVICEINSTALLER serviceinstaller REQUIRED)
@@ -62,7 +62,7 @@ include_directories(
     ${NYX_INCLUDE_DIRS}
     ${PBNJSON_CPP_INCLUDE_DIRS}
     ${SQLITE3_INCLUDE_DIRS}
-    ${CJSON_INCLUDE_DIRS}
+    ${JSON_INCLUDE_DIRS}
     ${OPENSSL_INCLUDE_DIRS}
     ${SERVICEINSTALLER_INCLUDE_DIRS}
     ${PMLOGLIB_INCLUDE_DIRS}
@@ -122,7 +122,7 @@ target_link_libraries(LunaAppManager
     ${PBNJSON_C_LIBRARIES}
     ${PBNJSON_CPP_LIBRARIES}
     ${SQLITE3_LIBRARIES}
-    ${CJSON_LIBRARIES}
+    ${JSON_LIBRARIES}
     ${OPENSSL_LIBRARIES}
     ${SERVICEINSTALLER_LIBRARIES}
     ${PMLOGLIB_LIBRARIES}
diff --git a/Src/base/BootManager.cpp b/Src/base/BootManager.cpp
index 59991be..cb01a25 100644
--- a/Src/base/BootManager.cpp
+++ b/Src/base/BootManager.cpp
@@ -43,7 +43,7 @@
 #include "Utils.h"
 #include "ApplicationProcessManager.h"
 
-#include "cjson/json.h"
+#include <json.h>
 #include <pbnjson.hpp>
 #include "JSONUtils.h"
 
diff --git a/Src/base/EventReporter.cpp b/Src/base/EventReporter.cpp
index 8413de0..7ed0bfe 100644
--- a/Src/base/EventReporter.cpp
+++ b/Src/base/EventReporter.cpp
@@ -22,7 +22,7 @@
 #include "Common.h"
 
 #include <glib.h>
-#include <cjson/json.h>
+#include <json.h>
 #include <sys/prctl.h>
 
 #include "EventReporter.h"
diff --git a/Src/base/application/ApplicationDescription.cpp b/Src/base/application/ApplicationDescription.cpp
index b617eb7..9134ced 100644
--- a/Src/base/application/ApplicationDescription.cpp
+++ b/Src/base/application/ApplicationDescription.cpp
@@ -24,7 +24,7 @@
 #include <stdio.h>
 #include <glib.h>
 
-#include <cjson/json.h>
+#include <json.h>
 
 #include "ApplicationDescription.h"
 #include "ApplicationStatus.h"
diff --git a/Src/base/application/ApplicationInstaller.cpp b/Src/base/application/ApplicationInstaller.cpp
index 473aad8..67703f4 100644
--- a/Src/base/application/ApplicationInstaller.cpp
+++ b/Src/base/application/ApplicationInstaller.cpp
@@ -47,8 +47,8 @@
 #include <sys/resource.h>
 #include <sys/mount.h>
 #include <unistd.h>
-#include "cjson/json.h"
-#include "cjson/json_util.h"
+#include <json.h>
+#include <json_util.h>
 #include <errno.h>
 
 #include <ftw.h>
@@ -2802,7 +2802,7 @@ Done:
 		json_object_object_add(root,"returnValue",json_object_new_boolean(true));
 		json_object_object_add(root,"result",json_object_new_int(queryCapacityResult));
 		std::string sizeStr = toSTLString<uint64_t>(spaceNeeded);
-		//returning as string to workaround cjson's inability to express unsigned int32
+		//returning as string to workaround json-c's inability to express unsigned int32
 		json_object_object_add(root,"spaceNeededInKB",json_object_new_string(sizeStr.c_str()));
 	}
 
diff --git a/Src/base/application/ApplicationInstaller.h b/Src/base/application/ApplicationInstaller.h
index e09d48c..6d54415 100644
--- a/Src/base/application/ApplicationInstaller.h
+++ b/Src/base/application/ApplicationInstaller.h
@@ -29,8 +29,8 @@
 #include <map>
 #include <vector>
 #include <glib.h>
-#include <cjson/json.h>
-#include <cjson/json_util.h>
+#include <json.h>
+#include <json_util.h>
 
 #include <lunaservice.h>
 
diff --git a/Src/base/application/ApplicationManager.cpp b/Src/base/application/ApplicationManager.cpp
index 0fac375..aeb4120 100644
--- a/Src/base/application/ApplicationManager.cpp
+++ b/Src/base/application/ApplicationManager.cpp
@@ -71,7 +71,7 @@
 #endif
 #include <sys/time.h>
 
-#include <cjson/json.h>
+#include <json.h>
 
 #include "MimeSystem.h"
 #include "Logging.h"
diff --git a/Src/base/application/ApplicationManagerService.cpp b/Src/base/application/ApplicationManagerService.cpp
index 8dec5a5..753902a 100644
--- a/Src/base/application/ApplicationManagerService.cpp
+++ b/Src/base/application/ApplicationManagerService.cpp
@@ -32,14 +32,14 @@
 #include "Utils.h"
 #include "ApplicationProcessManager.h"
 
-#include <cjson/json_object.h>
+#include <json_object.h>
 #include "lunaservice.h"
 
 #include <QBitArray>
 #include <QList>
 #include <QUrl>
 
-#include <cjson/json.h>
+#include <json.h>
 #include <glib.h>
 #include <map>
 #include <stdlib.h>
diff --git a/Src/base/application/ApplicationStatus.cpp b/Src/base/application/ApplicationStatus.cpp
index 43cd05f..5e76526 100644
--- a/Src/base/application/ApplicationStatus.cpp
+++ b/Src/base/application/ApplicationStatus.cpp
@@ -24,7 +24,7 @@
 #include "ApplicationStatus.h"
 
 #include <glib.h>
-#include <cjson/json.h>
+#include <json.h>
 
 ApplicationStatus::ApplicationStatus(json_object* item)
 	: id("")
diff --git a/Src/base/application/CmdResourceHandlers.cpp b/Src/base/application/CmdResourceHandlers.cpp
index 735f882..2bd105c 100644
--- a/Src/base/application/CmdResourceHandlers.cpp
+++ b/Src/base/application/CmdResourceHandlers.cpp
@@ -26,8 +26,8 @@
 #include <string>
 #include "CmdResourceHandlers.h"
 #include "MimeSystem.h"
-#include <cjson/json.h>
-#include <cjson/json_util.h>
+#include <json.h>
+#include <json_util.h>
 
 /**
  * Constructor.
diff --git a/Src/base/application/LaunchPoint.cpp b/Src/base/application/LaunchPoint.cpp
index 35ffab1..a530ebc 100644
--- a/Src/base/application/LaunchPoint.cpp
+++ b/Src/base/application/LaunchPoint.cpp
@@ -23,7 +23,7 @@
 
 #include <stdio.h>
 #include <glib.h>
-#include <cjson/json.h>
+#include <json.h>
 
 #include "ApplicationDescription.h"
 #include "PackageDescription.h"
diff --git a/Src/base/application/MimeSystem.cpp b/Src/base/application/MimeSystem.cpp
index 6f3ac64..e628c32 100644
--- a/Src/base/application/MimeSystem.cpp
+++ b/Src/base/application/MimeSystem.cpp
@@ -25,8 +25,8 @@
 #include <stdio.h>
 #include <unistd.h>
 
-#include <cjson/json.h>
-#include <cjson/json_util.h>
+#include <json.h>
+#include <json_util.h>
 #include <glib.h>
 #include "MimeSystem.h"
 #include "MutexLocker.h"
diff --git a/Src/base/application/PackageDescription.h b/Src/base/application/PackageDescription.h
index 9c4ca0b..fbe16a3 100644
--- a/Src/base/application/PackageDescription.h
+++ b/Src/base/application/PackageDescription.h
@@ -25,7 +25,7 @@
 #include <string>
 #include <stdint.h>
 #include <vector>
-#include <cjson/json.h>
+#include <json.h>
 
 struct json_object;
 
diff --git a/Src/base/application/ServiceDescription.cpp b/Src/base/application/ServiceDescription.cpp
index e06951e..2aa4136 100644
--- a/Src/base/application/ServiceDescription.cpp
+++ b/Src/base/application/ServiceDescription.cpp
@@ -22,7 +22,7 @@
 #include <stdio.h>
 #include <glib.h>
 
-#include <cjson/json.h>
+#include <json.h>
 
 #include "ServiceDescription.h"
 #include "Utils.h"
diff --git a/Src/remote/WebAppMgrProxy.cpp b/Src/remote/WebAppMgrProxy.cpp
index ae79c85..266004b 100644
--- a/Src/remote/WebAppMgrProxy.cpp
+++ b/Src/remote/WebAppMgrProxy.cpp
@@ -20,7 +20,7 @@
 #include "Common.h"
 
 #include <string.h>
-#include <cjson/json.h>
+#include <json.h>
 #include <sys/time.h>
 #include <sys/resource.h>
 #include <sys/prctl.h>
-- 
2.2.1

