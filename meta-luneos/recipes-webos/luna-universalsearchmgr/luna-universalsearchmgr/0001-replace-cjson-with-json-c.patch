From 139df30b34e077553db1ecca7e0ce116cf0f89b3 Mon Sep 17 00:00:00 2001
From: Martin Jansa <Martin.Jansa@gmail.com>
Date: Fri, 19 Dec 2014 18:56:53 +0100
Subject: [PATCH] replace cjson with json-c

Signed-off-by: Martin Jansa <Martin.Jansa@gmail.com>
---
 CMakeLists.txt                          | 10 +++++-----
 README.md                               |  2 +-
 Src/OpenSearchHandler.cpp               |  2 +-
 Src/UniversalSearchPrefsDb.cpp          |  2 +-
 include/public/SearchItemsManager.h     |  2 +-
 include/public/SearchServiceManager.h   |  2 +-
 include/public/UniversalSearchService.h |  2 +-
 7 files changed, 11 insertions(+), 11 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 5e73044..1ff3ab9 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -42,10 +42,10 @@ webos_add_compiler_flags(ALL ${GXML2_CFLAGS})
 pkg_check_modules(SQLITE3 REQUIRED sqlite3)
 webos_add_compiler_flags(ALL ${SQLITE3_CFLAGS})
 
-# -- check for cjson
-pkg_check_modules(CJSON REQUIRED cjson)
-include_directories(CJSON_INCLUDE_DIRS)
-webos_add_compiler_flags(ALL ${CJSON_CFLAGS})
+# -- check for json-c
+pkg_check_modules(JSON REQUIRED json-c)
+include_directories(JSON_INCLUDE_DIRS)
+webos_add_compiler_flags(ALL ${JSON_CFLAGS})
 
 # -- check for LS2 (internally depends on pmloglib)
 pkg_check_modules(LS2 REQUIRED luna-service2)
@@ -68,7 +68,7 @@ target_link_libraries(LunaUniversalSearchMgr
                       ${GTHREAD2_LDFLAGS}
                       ${GXML2_LDFLAGS}
                       ${SQLITE3_LDFLAGS}
-                      ${CJSON_LDFLAGS}
+                      ${JSON_LDFLAGS}
                       ${LS2_LDFLAGS}
                       )
 
diff --git a/README.md b/README.md
index 99e4c12..bf7c111 100644
--- a/README.md
+++ b/README.md
@@ -107,7 +107,7 @@ Below are the tools and libraries (and their minimum versions) required to build
 * gthread-2.0
 * libxml-2.0
 * sqlite3
-* openwebos/cjson
+* json-c 0.11
 * openwebos/luna-service2
 
 ### Building Standalone
diff --git a/Src/OpenSearchHandler.cpp b/Src/OpenSearchHandler.cpp
index 12e3847..21236e4 100644
--- a/Src/OpenSearchHandler.cpp
+++ b/Src/OpenSearchHandler.cpp
@@ -23,7 +23,7 @@
 #include <dirent.h>
 #include <sys/types.h>
 #include <lunaservice.h>
-#include <cjson/json.h>
+#include <json.h>
 #include <libxml/xmlreader.h>
 #include <unistd.h>
 #include "OpenSearchHandler.h"
diff --git a/Src/UniversalSearchPrefsDb.cpp b/Src/UniversalSearchPrefsDb.cpp
index d08658c..cf5e542 100644
--- a/Src/UniversalSearchPrefsDb.cpp
+++ b/Src/UniversalSearchPrefsDb.cpp
@@ -17,7 +17,7 @@
 // LICENSE@@@
 
 #include <glib.h>
-#include <cjson/json.h>
+#include <json.h>
 #include <string.h>
 #include <iostream>
 #include <sstream>
diff --git a/include/public/SearchItemsManager.h b/include/public/SearchItemsManager.h
index abed7c4..70b2966 100644
--- a/include/public/SearchItemsManager.h
+++ b/include/public/SearchItemsManager.h
@@ -22,7 +22,7 @@
 #include <string>
 #include <glib.h>
 #include <iostream>
-#include <cjson/json.h>
+#include <json.h>
 #include <list>
 
 #include "UniversalSearchPrefsDb.h"
diff --git a/include/public/SearchServiceManager.h b/include/public/SearchServiceManager.h
index 92b11ef..f7f6014 100644
--- a/include/public/SearchServiceManager.h
+++ b/include/public/SearchServiceManager.h
@@ -20,7 +20,7 @@
 #define SEARCHSERVICEMANAGER_H_
 
 #include <string>
-#include <cjson/json.h>
+#include <json.h>
 #include <glib.h>
 #include <list>
 
diff --git a/include/public/UniversalSearchService.h b/include/public/UniversalSearchService.h
index 177e857..0b46ed4 100644
--- a/include/public/UniversalSearchService.h
+++ b/include/public/UniversalSearchService.h
@@ -26,7 +26,7 @@
 #include <glib.h>
 #include <sqlite3.h>
 #include <lunaservice.h>
-#include <cjson/json.h>
+#include <json.h>
 
 #include "SearchItemsManager.h"
 #include "SearchServiceManager.h"
-- 
2.2.1

