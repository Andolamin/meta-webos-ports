description "Check for missing SSL configuration bits and create them if needed"

start on stopped finish

console output

script
    if [ ! -d /var/ssl/trustedcerts ] ; then
        mkdir -p /var/ssl/trustedcerts
        for f in `find /etc/ssl/certs -type l -iname *.pem -print` ; do
            cp -P $f /var/ssl/trustedcerts/
        done
        c_rehash /var/ssl/trustedcerts
    fi

    if [ ! -f /var/ssl/serial ] ; then
        mkdir -p /var/ssl/public
        echo '01' > /var/ssl/serial
    fi

    if [ ! -f /var/ssl/index.txt ] ; then
        mkdir -p /var/ssl/certs
        mkdir -p /var/ssl/private
        touch /var/ssl/index.txt
    fi
end script
