From 449fbfae5c07b9a627093105c1b9eb79d1fd1434 Mon Sep 17 00:00:00 2001
From: Simon Busch <morphis@gravedo.de>
Date: Tue, 28 Aug 2012 23:34:03 +0200
Subject: [PATCH] plugins: palm: remove dependency on libhid and fix different
 build errors

Signed-off-by: Simon Busch <morphis@gravedo.de>
---
 src/plugins/platforms/palm/hidd_support.h  |    9 +++++++++
 src/plugins/platforms/palm/hiddkbd_qpa.cpp |    4 +++-
 src/plugins/platforms/palm/hiddkbd_qpa.h   |    2 +-
 src/plugins/platforms/palm/hiddtp_qpa.cpp  |    2 +-
 src/plugins/platforms/palm/hiddtp_qpa.h    |    2 +-
 src/plugins/platforms/palm/palm.pro        |    2 +-
 6 files changed, 16 insertions(+), 5 deletions(-)
 create mode 100644 src/plugins/platforms/palm/hidd_support.h

diff --git a/src/plugins/platforms/palm/hidd_support.h b/src/plugins/platforms/palm/hidd_support.h
new file mode 100644
index 0000000..7c81539
--- /dev/null
+++ b/src/plugins/platforms/palm/hidd_support.h
@@ -0,0 +1,9 @@
+#ifndef HID_SUPPORT_H_
+#define HID_SUPPORT_H_
+
+#define DEV_TYPE_KEYBOARD   0x00
+#define DEV_TYPE_MOUSE      0x01
+#define DEV_TYPE_JOYSTICK   0x02
+
+
+#endif
diff --git a/src/plugins/platforms/palm/hiddkbd_qpa.cpp b/src/plugins/platforms/palm/hiddkbd_qpa.cpp
index 2383aad..7b23142 100644
--- a/src/plugins/platforms/palm/hiddkbd_qpa.cpp
+++ b/src/plugins/platforms/palm/hiddkbd_qpa.cpp
@@ -20,6 +20,7 @@
 **
 ****************************************************************************/
 
+#include <unistd.h>
 #include <Qt>
 #include <QKeyEvent>
 #include <QApplication>
@@ -28,11 +29,12 @@
 #include <errno.h>
 #include <glib.h>
 #include "hiddkbd_qpa.h"
-#include <hid/IncsPublic/HidLib.h>
+#include "hidd_support.h"
 #include "InputControl.h"
 #include "NyxInputControl.h"
 #include "webosDeviceKeymap.h"
 #include <dlfcn.h>
+#include <linux/input.h>
 
 #include <QWSKeyboardHandler>
 #include <QKbdDriverFactory>
diff --git a/src/plugins/platforms/palm/hiddkbd_qpa.h b/src/plugins/platforms/palm/hiddkbd_qpa.h
index bddfd0a..e11fb4b 100644
--- a/src/plugins/platforms/palm/hiddkbd_qpa.h
+++ b/src/plugins/platforms/palm/hiddkbd_qpa.h
@@ -28,7 +28,7 @@
 #include <qsocketnotifier.h>
 #include <map>
 #include "webosDeviceKeymap.h"
-#include <hid/IncsPublic/HidLib.h>
+#include "hidd_support.h"
 
 #include <nyx/nyx_client.h>
 #include <QWSKeyboardHandler>
diff --git a/src/plugins/platforms/palm/hiddtp_qpa.cpp b/src/plugins/platforms/palm/hiddtp_qpa.cpp
index 6dfe3b9..d2c2a2a 100644
--- a/src/plugins/platforms/palm/hiddtp_qpa.cpp
+++ b/src/plugins/platforms/palm/hiddtp_qpa.cpp
@@ -20,7 +20,7 @@
 **
 ****************************************************************************/
 
-
+#include <unistd.h>
 #include <fcntl.h>
 #include <sys/socket.h>
 #include <sys/un.h>
diff --git a/src/plugins/platforms/palm/hiddtp_qpa.h b/src/plugins/platforms/palm/hiddtp_qpa.h
index dc9688e..c98c4b5 100644
--- a/src/plugins/platforms/palm/hiddtp_qpa.h
+++ b/src/plugins/platforms/palm/hiddtp_qpa.h
@@ -31,7 +31,7 @@
 #include <stdio.h>
 #include <glib.h>
 
-#include <hid/IncsPublic/HidLib.h>
+#include "hidd_support.h"
 #include <nyx/nyx_client.h>
 
 #include "FlickGesture.h"
diff --git a/src/plugins/platforms/palm/palm.pro b/src/plugins/platforms/palm/palm.pro
index 895fd53..4c0fb0f 100644
--- a/src/plugins/platforms/palm/palm.pro
+++ b/src/plugins/platforms/palm/palm.pro
@@ -38,7 +38,7 @@ SOURCES +=  hiddtp_qpa.cpp \
             NyxInputControl.cpp \
             hiddkbd_qpa.cpp
 
-LIBS_PRIVATE += -lnyx -lhid -ldl
+LIBS_PRIVATE += -lnyx -ldl
 }
 
 include(../fontdatabases/genericunix/genericunix.pri)
-- 
1.7.9.5

